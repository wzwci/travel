<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>旅遊助手</title>
  <link rel="stylesheet" href="./travel2/css/index2.css">
</head>

<body>
  <div class="app-header">
    <div class="app-title">小精靈旅遊助手</div>
  </div>

  <div class="nav-tabs">
    <button class="nav-tab active" onclick="showSection('home')">首頁</button>
    <button class="nav-tab inactive" onclick="showSection('itinerary')">行程</button>
    <button class="nav-tab inactive" onclick="showSection('checklist')">清單</button>
    <button class="nav-tab inactive" onclick="showSection('expense')">記帳</button>
    <button class="nav-tab inactive" onclick="showSection('info')">資訊</button>
  </div>

  <div class="container">
    <!-- 首頁 -->
    <div id="home" class="content-section active">
      <div class="card">
        <h3 class="card-title">🌤️ 一週天氣預報</h3>
        <div class="weather-grid" id="weatherGrid"></div>
      </div>

      <div class="card">
        <h3 class="card-title">💱 匯率即時換算</h3>
        <div class="exchange-section">
          <div class="exchange-rate">當前匯率：1 TWD = 4.7 JPY</div>
          <div class="input-row">
            <label>日幣 (JPY) ¥：</label>
            <input type="number" id="jpyInput" value="100000" oninput="convertFromJPY()">
          </div>
          <div class="input-row">
            <label>台幣 (TWD) NT$：</label>
            <input type="number" id="twdInput" value="21277" oninput="convertFromTWD()">
          </div>
          <div class="alert-box" id="alertBox"></div>
          <div class="tax-info">免稅提醒：單筆商品未稅價需超過 ¥5,000 方可免稅</div>
        </div>
      </div>

      <div class="card">
        <h3 class="card-title">⚡ 快速資訊</h3>
        <div class="info-grid">
          <div class="info-card" onclick="openEmergencyModal()">
            <div class="info-icon">🚨</div>
            <div class="info-title">緊急電話</div>
            <div class="info-content">查看緊急聯絡資訊</div>
          </div>
          <div class="info-card" onclick="openJapaneseModal()">
            <div class="info-icon">🗣️</div>
            <div class="info-title">求生日語</div>
            <div class="info-content">常用日語會話</div>
          </div>
          <div class="info-card" onclick="openReminderModal()">
            <div class="info-icon">⚠️</div>
            <div class="info-title">重要提醒</div>
            <div class="info-content">旅遊注意事項</div>
          </div>
        </div>
      </div>

      <a href="https://www.vjw.digital.go.jp/" target="_blank" class="link-button">
        Visit Japan Web 入境網站
      </a>
    </div>

    <!-- 行程 -->
    <div id="itinerary" class="content-section">
      <!-- 天數切換 -->
      <div class="day-selector">
        <button class="day-nav-btn" onclick="changeDay(-1)">‹</button>
        <div class="day-title" id="dayTitle">Day 1</div>
        <button class="day-nav-btn" onclick="changeDay(1)">›</button>
      </div>

      <!-- 日期顯示 -->
      <div class="date-display" id="dateDisplay">12/25 (三) - 抵達與安頓</div>

      <div class="card">
        <h3 class="card-title">🌡️ 即時天氣</h3>
        <div id="currentWeatherDisplay" style="text-align: center; padding: 20px;">
          <div style="font-size: 4rem; margin-bottom: 10px;">☀️</div>
          <div style="font-size: 2rem; font-weight: bold; color: #8b7355; margin-bottom: 5px;">18°C</div>
          <div style="font-size: 1.1rem; color: #a89480;">晴朗 · 濕度 45% · 風速 5 km/h</div>
        </div>
      </div>

      <div class="card">
        <h3 class="card-title">📅 今日行程</h3>
        <div id="dailyItineraryList" class="timeline-container"></div>
        <button class="btn" onclick="openActivityModal()" style="width: 100%; margin-top: 15px;">➕ 新增活動</button>
      </div>
    </div>

    <!-- 行程
    <div id="itinerary" class="content-section">
      <div class="card">
        <h3 class="card-title">🌡️ 即時天氣</h3>
        <div style="text-align: center; padding: 20px;">
          <div style="font-size: 4rem; margin-bottom: 10px;">☀️</div>
          <div style="font-size: 2rem; font-weight: bold; color: #8b7355; margin-bottom: 5px;">18°C</div>
          <div style="font-size: 1.1rem; color: #a89480;">晴朗 · 濕度 45% · 風速 5 km/h</div>
        </div>
      </div>

      <div class="card">
        <h3 class="card-title">📅 我的行程</h3>
        <div id="itineraryList"></div>
        <button class="btn" onclick="openItineraryModal()" style="width: 100%; margin-top: 15px;">➕ 新增行程</button>
      </div>
    </div> -->

    <!-- 清單 -->
    <div id="checklist" class="content-section">
      <div class="card">
        <h3 class="card-title">✅ 打包清單</h3>
        <div id="checklistItems"></div>
        <button class="btn" onclick="openChecklistModal()" style="width: 100%; margin-top: 15px;">➕ 新增項目</button>
      </div>
    </div>

    <!-- 記帳 -->
    <div id="expense" class="content-section">
      <div class="card">
        <h3 class="card-title">💰 支出記帳</h3>
        <div id="expenseList"></div>
        <div style="display: flex; gap: 10px; margin-top: 15px;">
          <button class="btn" onclick="openScanModal()" style="flex: 2;">📷 掃描發票自動記帳</button>
          <button class="btn" onclick="openExpenseAddModal()"
            style="flex: 1; background: linear-gradient(135deg, #e8e8d0 0%, #d8d8c0 100%); color: #8b7355;">➕
            新增</button>
        </div>
      </div>
      <div class="total-card">
        <div class="total-label">總計支出</div>
        <div class="total-amount" id="totalAmount">NT$ 0</div>
      </div>
    </div>

    <!-- 資訊 -->
    <div id="info" class="content-section">
      <div class="card">
        <h3 class="card-title">✈️ 航班資訊</h3>
        <div id="flightInfo"></div>
        <button class="btn" onclick="openFlightModal()" style="width: 100%; margin-top: 15px;">✏️ 編輯航班資訊</button>
      </div>

      <div class="card">
        <h3 class="card-title">🏨 飯店資訊</h3>
        <div id="hotelInfo"></div>
        <button class="btn" onclick="openHotelModal()" style="width: 100%; margin-top: 15px;">✏️ 編輯飯店資訊</button>
      </div>
    </div>
  </div>

  <!-- 緊急電話 Modal -->
  <div id="emergencyModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>🚨 緊急電話</h2>
        <button class="close-btn" onclick="closeModal('emergencyModal')">✕</button>
      </div>
      <div style="line-height: 2.2; padding: 10px;">
        <p style="margin-bottom: 15px;"><strong>🚓 警察局：</strong><a href="tel:110"
            style="color: #8b7355; text-decoration: none; font-weight: bold;">110</a></p>
        <p style="margin-bottom: 15px;"><strong>🚒 消防/救護車：</strong><a href="tel:119"
            style="color: #8b7355; text-decoration: none; font-weight: bold;">119</a></p>
        <p style="margin-bottom: 15px;"><strong>🏥 東京都醫療機構：</strong><a href="tel:03-5272-0303"
            style="color: #8b7355; text-decoration: none; font-weight: bold;">03-5272-0303</a></p>
        <p style="margin-bottom: 15px;"><strong>📞 緊急翻譯服務：</strong><a href="tel:#9110"
            style="color: #8b7355; text-decoration: none; font-weight: bold;">#9110</a></p>
        <p style="margin-bottom: 15px;"><strong>🇹🇼 駐日代表處：</strong><a href="tel:03-3280-7811"
            style="color: #8b7355; text-decoration: none; font-weight: bold;">03-3280-7811</a></p>
      </div>
    </div>
  </div>

  <!-- 求生日語 Modal -->
  <div id="japaneseModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>🗣️ 求生日語</h2>
        <button class="close-btn" onclick="closeModal('japaneseModal')">✕</button>
      </div>
      <div style="line-height: 2.5; padding: 10px;">
        <p><strong>不好意思</strong> - すみません (Sumimasen)</p>
        <p><strong>謝謝</strong> - ありがとうございます (Arigatou gozaimasu)</p>
        <p><strong>多少錢？</strong> - いくらですか？(Ikura desuka?)</p>
        <p><strong>我不會說日語</strong> - 日本語が話せません (Nihongo ga hanasemasen)</p>
        <p><strong>廁所在哪裡？</strong> - トイレはどこですか？(Toire wa doko desuka?)</p>
        <p><strong>請幫幫我</strong> - 助けてください (Tasukete kudasai)</p>
        <p><strong>我迷路了</strong> - 道に迷いました (Michi ni mayoimashita)</p>
        <p><strong>這個/那個</strong> - これ/それ (Kore/Sore)</p>
      </div>
    </div>
  </div>

  <!-- 重要提醒 Modal -->
  <div id="reminderModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>⚠️ 重要提醒</h2>
        <button class="close-btn" onclick="closeModal('reminderModal')">✕</button>
      </div>
      <div style="line-height: 2.2; padding: 10px;">
        <p>✅ 出發前確認護照有效期限（需6個月以上）</p>
        <p>✅ 記得填寫 Visit Japan Web</p>
        <p>✅ 準備日幣現金，部分店家不收信用卡</p>
        <p>✅ 下載 Google Maps 離線地圖</p>
        <p>✅ 購買旅遊保險</p>
        <p>✅ 記得帶轉接頭（日本插座為 A 型）</p>
        <p>✅ 垃圾分類：可燃、不可燃、資源回收</p>
        <p>✅ 搭乘電扶梯靠左站立</p>
        <p>✅ 電車內請勿講電話</p>
      </div>
    </div>
  </div>

  <!-- 新增行程 Modal -->
  <div id="itineraryModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="itineraryModalTitle">➕ 新增行程</h2>
        <button class="close-btn" onclick="closeModal('itineraryModal')">✕</button>
      </div>
      <div class="form-group">
        <label>時間</label>
        <input type="time" id="itineraryTime">
      </div>
      <div class="form-group">
        <label>地點</label>
        <input type="text" id="itineraryPlace" placeholder="例：淺草寺">
      </div>
      <div class="form-group">
        <label>描述</label>
        <textarea id="itineraryDesc" rows="3" placeholder="行程描述..."></textarea>
      </div>
      <div class="modal-buttons">
        <button class="btn-save" onclick="saveItinerary()" style="flex: 1;">✅ 儲存</button>
        <button class="btn-delete" onclick="deleteItinerary()" id="itineraryDeleteBtn" style="display: none;">🗑️
          刪除</button>
      </div>
    </div>
  </div>

  <!-- 新增清單 Modal -->
  <div id="checklistModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>➕ 新增項目</h2>
        <button class="close-btn" onclick="closeModal('checklistModal')">✕</button>
      </div>
      <div class="form-group">
        <label>項目名稱</label>
        <input type="text" id="checklistItem" placeholder="例：護照、充電器">
      </div>
      <button class="btn-save" onclick="saveChecklistItem()">✅ 新增</button>
    </div>
  </div>

  <!-- 新增支出 Modal -->
  <div id="expenseAddModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="expenseModalTitle">➕ 新增支出</h2>
        <button class="close-btn" onclick="closeModal('expenseAddModal')">✕</button>
      </div>
      <div class="form-group">
        <label>支出類型</label>
        <select id="expenseType">
          <option value="機票">✈️ 機票</option>
          <option value="住宿">🏨 住宿</option>
          <option value="餐費">🍜 餐費</option>
          <option value="交通">🚗 交通</option>
          <option value="購物">🛍️ 購物</option>
          <option value="娛樂">🎭 娛樂</option>
          <option value="其他">💰 其他</option>
        </select>
      </div>
      <div class="form-group">
        <label>金額 (NT$)</label>
        <input type="number" id="expenseAmount" placeholder="請輸入金額">
      </div>
      <div class="form-group">
        <label>日期</label>
        <input type="date" id="expenseDate">
      </div>
      <div class="form-group">
        <label>備註 (選填)</label>
        <textarea id="expenseDetails" rows="3" placeholder="新增備註說明..."></textarea>
      </div>
      <div class="modal-buttons">
        <button class="btn-save" onclick="saveExpense()" style="flex: 1;">✅ 儲存</button>
        <button class="btn-delete" onclick="deleteExpense()" id="expenseDeleteBtn" style="display: none;">🗑️
          刪除</button>
      </div>
    </div>
  </div>

  <!-- 掃描發票 Modal -->
  <div id="scanModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>📷 掃描發票</h2>
        <button class="close-btn" onclick="closeModal('scanModal')">✕</button>
      </div>
      <div
        style="border: 4px dashed #d4a574; border-radius: 20px; padding: 60px 30px; text-align: center; margin-bottom: 25px; background: rgba(232, 232, 208, 0.3);">
        <div style="font-size: 70px; margin-bottom: 20px;">📸</div>
        <div style="color: #8b7355; margin-bottom: 25px; font-size: 1.1rem;">上傳發票照片自動識別金額</div>
        <input type="file" id="receiptFile" accept="image/*" onchange="handleScanReceipt(event)" style="display: none;">
        <label for="receiptFile"
          style="display: inline-block; background: linear-gradient(135deg, #d4a574 0%, #b8956a 100%); color: white; padding: 15px 40px; border-radius: 15px; cursor: pointer; font-weight: 700; font-size: 1.05rem;">選擇照片</label>
      </div>
      <div style="font-size: 0.9rem; color: #a89480; text-align: center;">* 此功能會自動識別發票金額與日期</div>
    </div>
  </div>

  <!-- 新增/編輯活動 Modal -->
<div id="activityModal" class="modal">
  <div class="modal-content" style="max-width: 600px;">
    <div class="modal-header">
      <h2 id="activityModalTitle">➕ 新增活動</h2>
      <button class="close-btn" onclick="closeModal('activityModal')">✕</button>
    </div>
    
    <div class="form-group">
      <label>時間</label>
      <input type="time" id="activityTime">
    </div>
    
    <div class="form-group">
      <label>地點名稱</label>
      <input type="text" id="activityPlace" placeholder="例：抵達關西機場">
    </div>
    
    <div class="form-group">
      <label>地址/代碼（選填）</label>
      <input type="text" id="activityAddress" placeholder="例：關西國際機場 (KIX)">
    </div>
    
    <div class="form-group">
      <label>Google Maps 連結（選填）</label>
      <input type="url" id="activityMapLink" placeholder="貼上 Google Maps 連結">
    </div>
    
    <div class="form-group">
      <label>標籤（選填，用逗號分隔）</label>
      <input type="text" id="activityTags" placeholder="例：呼應巧克餅, LeTAO 夾心餅乾">
    </div>
    
    <div class="form-group">
      <label>交通資訊（選填，每行一項）</label>
      <textarea id="activityTransport" rows="3" placeholder="例：&#10;入境｜大廳搭手扶梯上 2F&#10;空橋｜前往關西機場站"></textarea>
    </div>
    
    <div class="form-group">
      <label>購票資訊（選填）</label>
      <input type="text" id="activityTicket" placeholder="例：購買 ICOCA卡">
    </div>
    
    <div class="form-group">
      <label>備註（選填）</label>
      <textarea id="activityNotes" rows="2" placeholder="例：入境、領行李、買 ICOCA"></textarea>
    </div>
    
    <div class="modal-buttons">
      <button class="btn-save" onclick="saveActivity()" style="flex: 1;">✅ 儲存</button>
      <button class="btn-delete" onclick="deleteActivity()" id="activityDeleteBtn" style="display: none;">🗑️ 刪除</button>
    </div>
  </div>
</div>

  <!-- 航班資訊 Modal -->
  <div id="flightModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>✈️ 航班資訊</h2>
        <button class="close-btn" onclick="closeModal('flightModal')">✕</button>
      </div>
      <div class="form-group">
        <label>去程航班</label>
        <input type="text" id="flightGo" placeholder="例：CI100">
      </div>
      <div class="form-group">
        <label>去程時間</label>
        <input type="datetime-local" id="flightGoTime">
      </div>
      <div class="form-group">
        <label>回程航班</label>
        <input type="text" id="flightBack" placeholder="例：CI101">
      </div>
      <div class="form-group">
        <label>回程時間</label>
        <input type="datetime-local" id="flightBackTime">
      </div>
      <button class="btn-save" onclick="saveFlight()">💾 儲存</button>
    </div>
  </div>

  <!-- 飯店資訊 Modal -->
  <div id="hotelModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>🏨 飯店資訊</h2>
        <button class="close-btn" onclick="closeModal('hotelModal')">✕</button>
      </div>
      <div class="form-group">
        <label>飯店名稱</label>
        <input type="text" id="hotelName" placeholder="例：東京希爾頓酒店">
      </div>
      <div class="form-group">
        <label>飯店地址</label>
        <textarea id="hotelAddress" rows="2" placeholder="飯店地址..."></textarea>
      </div>
      <div class="form-group">
        <label>電話</label>
        <input type="tel" id="hotelPhone" placeholder="例：03-1234-5678">
      </div>
      <div class="form-group">
        <label>入住日期</label>
        <input type="date" id="hotelCheckin">
      </div>
      <div class="form-group">
        <label>退房日期</label>
        <input type="date" id="hotelCheckout">
      </div>
      <button class="btn-save" onclick="saveHotel()">💾 儲存</button>
    </div>
  </div>

  <script src="./travel2/js/index2.js"></script>
</body>

</html>
